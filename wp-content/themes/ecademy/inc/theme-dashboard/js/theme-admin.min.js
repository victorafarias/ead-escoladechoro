(function ($) {
    "use strict";

    $(document).ready(function () {
        // Handle notice dismissal for purchase and plugin notices
        $(".ecademy-purchase-notice .notice-dismiss").on("click", function () {
            let url = new URL(location.href);
            url.searchParams.append("dismissed", 1);
            location.href = url;
        });

        $(".ecademy-plugin-purchase-notice .notice-dismiss").on("click", function () {
            let url = new URL(location.href);
            url.searchParams.append("plugin_dismissed", 1);
            location.href = url;
        });

        // Fetch more theme data from API
        const apiUrl = "https://themes.envytheme.com/tools/et-tf-preview-api/";

        $.getJSON(apiUrl)
            .done(function (data) {
                if (data.status === "success") {
                    $(".et-com-themes").html(data.data.themes_templates);
                    $(".et-tf-themes").html(data.data.tf_themes_templates);
                    $(".more-et-theme-doc").html(data.data.more_theme_doc);
                } else {
                    console.log("Error fetching data");
                }
            })
            .fail(function (jqxhr, textStatus, error) {
                console.error("Request Failed:", textStatus, error);
                console.log("Error fetching data");
            });

        // Sticky support menu on scroll
        if ($(".support-sub-menu").length) {
            $(window).on("scroll", function () {
                let scrollTop = $(window).scrollTop();
                $(".support-sub-menu").toggleClass("sticky", scrollTop >= 350);
            });
        }

        // Smooth scroll for support menu links
        $(".support-sub-menu a").on("click", function (event) {
            event.preventDefault();
            let target = $(this).attr("href");

            if ($(target).length) {
                $("html, body").animate(
                    { scrollTop: $(target).offset().top - 50 },
                    500
                );
            }
        });
    });
})(jQuery);
